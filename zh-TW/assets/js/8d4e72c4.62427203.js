"use strict";(self.webpackChunkgravity_doc=self.webpackChunkgravity_doc||[]).push([[212],{4819:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>d,toc:()=>o});var s=i(4848),r=i(8453);const t={},l="Prepare Kubernetes",d={id:"install_guide/install_k8",title:"Prepare Kubernetes",description:"1. Import Images",source:"@site/docs/install_guide/install_k8.md",sourceDirName:"install_guide",slug:"/install_guide/install_k8",permalink:"/zh-TW/docs/install_guide/install_k8",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"docSidebar",previous:{title:"Context",permalink:"/zh-TW/docs/install_guide/env"},next:{title:"Gravity Deployment",permalink:"/zh-TW/docs/install_guide/deployment"}},c={},o=[{value:"<em>1.</em> Import Images",id:"1-import-images",level:2},{value:"<em>1.1</em> Download and unzip the compressed files",id:"11-download-and-unzip-the-compressed-files",level:3},{value:"<em>1.2</em> Loading images",id:"12-loading-images",level:3},{value:"<em>1.2.1</em> Older Kubernetes Versions",id:"121-older-kubernetes-versions",level:4},{value:"<em>1.2.2</em> Different Container Engines",id:"122-different-container-engines",level:4},{value:"<em>2.</em> Configure Gravity Environment",id:"2-configure-gravity-environment",level:2},{value:"<em>2.1</em> Create Namespace",id:"21-create-namespace",level:3},{value:"<em>2.2</em> Set-up Gitea",id:"22-set-up-gitea",level:3},{value:"<em>2.2.1</em> Deploy",id:"221-deploy",level:4},{value:"<em>2.2.2</em> Verify",id:"222-verify",level:4}];function a(e){const n={a:"a",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"prepare-kubernetes",children:"Prepare Kubernetes"})}),"\n",(0,s.jsxs)(n.h2,{id:"1-import-images",children:[(0,s.jsx)(n.em,{children:"1."})," Import Images"]}),"\n",(0,s.jsxs)(n.h3,{id:"11-download-and-unzip-the-compressed-files",children:[(0,s.jsx)(n.em,{children:"1.1"})," Download and unzip the compressed files"]}),"\n",(0,s.jsxs)(n.p,{children:["Go to ",(0,s.jsx)(n.a,{href:"/zh-TW/docs/install_guide/requirements",children:"Requirement Page"})," to download the latest install packages."]}),"\n",(0,s.jsxs)(n.h3,{id:"12-loading-images",children:[(0,s.jsx)(n.em,{children:"1.2"})," Loading images"]}),"\n",(0,s.jsxs)(n.h4,{id:"121-older-kubernetes-versions",children:[(0,s.jsx)(n.em,{children:"1.2.1"})," Older Kubernetes Versions"]}),"\n",(0,s.jsx)(n.p,{children:"If your kubernetes version is older then v1.24, and you use docker to manage your images, enter the command below"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"docker load -i <image_name>\n"})}),"\n",(0,s.jsxs)(n.h4,{id:"122-different-container-engines",children:[(0,s.jsx)(n.em,{children:"1.2.2"})," Different Container Engines"]}),"\n",(0,s.jsxs)(n.p,{children:["If your kubernetes is v1.24 or newer, ",(0,s.jsx)(n.code,{children:"docker load"})," command is deprecated\n, find out the version of your ",(0,s.jsx)(n.code,{children:"control-plane"})," by entering the following command"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"kubectl get node -o wide\n"})}),"\n",(0,s.jsxs)(n.p,{children:["If your container engine is ",(0,s.jsx)(n.code,{children:"crio"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo podman load <image>\n"})}),"\n",(0,s.jsxs)(n.p,{children:["If your container engine is ",(0,s.jsx)(n.code,{children:"containerd"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"ctr -n k8s.io image import <image>\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"2-configure-gravity-environment",children:[(0,s.jsx)(n.em,{children:"2."})," Configure Gravity Environment"]}),"\n",(0,s.jsxs)(n.h3,{id:"21-create-namespace",children:[(0,s.jsx)(n.em,{children:"2.1"})," Create Namespace"]}),"\n",(0,s.jsxs)(n.p,{children:["If namespace is set as ",(0,s.jsx)(n.code,{children:"bbg-gravity"})," all the ",(0,s.jsx)(n.code,{children:".yaml"})," files pertaining the same gravity cluster should have the same namespace configured in the ",(0,s.jsx)(n.code,{children:".yaml"})," files"]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["\u26a0\ufe0f"," ",(0,s.jsx)(n.strong,{children:"Caution:"})," Any ",(0,s.jsx)(n.code,{children:".yaml"})," file names may vary accordingly. Please verify whether your ",(0,s.jsx)(n.code,{children:".yaml"})," files match its acutal names."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Enter the command below"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f 01-bbg-namespace.yaml\n"})}),"\n",(0,s.jsx)(n.p,{children:"Alternatively, create our own namespace"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"kubectl create ns <namespace_name>\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"22-set-up-gitea",children:[(0,s.jsx)(n.em,{children:"2.2"})," Set-up Gitea"]}),"\n",(0,s.jsx)(n.p,{children:"Gitea is a lightweight version control repository. In this example we use gitea to store atomic files."}),"\n",(0,s.jsxs)(n.h4,{id:"221-deploy",children:[(0,s.jsx)(n.em,{children:"2.2.1"})," Deploy"]}),"\n",(0,s.jsx)(n.p,{children:"Enter the command below"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"kubectl apply -f 02-bbg-gitea.yaml\n"})}),"\n",(0,s.jsxs)(n.h4,{id:"222-verify",children:[(0,s.jsx)(n.em,{children:"2.2.2"})," Verify"]}),"\n",(0,s.jsx)(n.p,{children:"Verify whether the pod was successfuly created"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"kubectl -n bbg-gravity get pods\t\n"})}),"\n",(0,s.jsx)(n.p,{children:"Verify whether the service is up"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"kubectl -n bbg-gravity get svc\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Acquire the node-port ",(0,s.jsx)(n.code,{children:"Cluster-IP"})]}),"\n",(0,s.jsxs)(n.p,{children:["Open a browser and connect to the node-port IP (i.e., ",(0,s.jsx)(n.a,{href:"http://192.168.100.154:31300",children:"http://192.168.100.154:31300)"}),"/)"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"image",src:i(9716).A+"",width:"3308",height:"470"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["Once nodeport is configured, it is accessible on any kubernetes node which means you can connect to the above ip ",(0,s.jsx)(n.code,{children:"http://192.168.1.61:31300"})," or ",(0,s.jsx)(n.code,{children:"http://192.168.1.61:31300"})]}),"\n",(0,s.jsxs)(n.p,{children:["If you are setting up gitea for the first time, you may need to complete the initial setup and enter the generated token in ",(0,s.jsx)(n.code,{children:"gitea-token.txt"})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},9716:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/install-29ecef39091176cbeec1e1e6540f7009.png"},8453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>d});var s=i(6540);const r={},t=s.createContext(r);function l(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);